# Stripe

## Set up the stripe CLI

### 1. Run Docker container

```bash
docker run --rm -it stripe/stripe-cli:latest
```


### 2. Set environment variables for the App in `.env`

```.dotenv
STRIPE_PUBLISHABLE_KEY=<publishable_key>
STRIPE_SECRET_KEY=<secret_key>
```

### 3. Start Nuxt with host mapping
```bash
pnpm dev --host=0.0.0.0
```

### 4. Forward events

```bash
docker run --rm -it stripe/stripe-cli:latest listen \
--forward-to http://host.docker.internal:3000/api/stripe/callback \
--api-key <sk_test_key>
```

You should get something like:
```
> Ready! You are using Stripe API Version [2023-10-16]. Your webhook signing secret is <whsec_...> (^C to quit)
```

Add the webhook secret to the `.env` file as `NUXT_STRIPE_WEBHOOK_SECRET=whsec_...`.



