# Stripe

## Links

- [Test cards](https://docs.stripe.com/testing)

## Set up the stripe CLI

### Prerequisites

- Stripe sandbox environment
- Stripe Publishable Key / Stripe Secret Key

### 1. Run Docker container

```bash
docker run --rm -it stripe/stripe-cli:latest
```

### 2. Forward events

```bash
docker run --rm -it stripe/stripe-cli:latest listen \
--forward-to http://host.docker.internal:3000/api/webhook/stripe \
--api-key <sk_test_key>
```

### 3. Set environment variables for the App in `.env`

```.dotenv
STRIPE_PUBLISHABLE_KEY=<publishable_key>
STRIPE_SECRET_KEY=<secret_key>
```

### 4. Start Nuxt with host mapping

> You will need to do this in a separate terminal window while stripe sync is running.

```bash
pnpm dev --host=0.0.0.0
```

You should get something like:

```text
> Ready! You are using Stripe API Version [2023-10-16]. Your webhook signing secret is <whsec_...> (^C to quit)
```

Add the webhook secret to the `.env` file as `NUXT_STRIPE_WEBHOOK_SECRET=whsec_...`.



